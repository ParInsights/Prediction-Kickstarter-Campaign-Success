View(ks.proj)
dtdf <- ks.proj[,-1:-2]
View(dtdf)

#Classification Tree
library(rpart)
sum(is.na(dtdf))
dtdf$launched_year <- unlist(dtdf$launched_year)
class(dtdf$launched_year)
str(dtdf)
dtree=rpart(status~.,data=dtdf,method="class",control=rpart.control(minsplit=30,cp=0.001))
plot(dtree)
text(dtree)
summary(dtree)
printcp(dtree)
plotcp(dtree)
printcp(dtree)
fancyRpartPlot(dtree)

Method.CORElearn3 <- CORElearn::attrEval(dtdf$status ~ ., data=dtdf,  estimator = "GainRatio")
(Method.CORElearn3)
dc.train <- dtdf[randindex[1:cutPt1_5],] #gets first 20% of rows based on randindex
dc.test <- dtdf[randindex[(cutPt1_5+1):dim(nbDf)[1]],]
fit <- rpart(dc.train$status ~ ., data = dc.train, method="class")
summary(fit)
predicted= predict(fit,dc.test, type="class")
(head(predicted,n=10))
(head(dc.test, n=10))
table(predicted, dc.test$status)
library(RWeka)
library(party)
dtree <- J48(status~., data = dtdf)
str(dtdf)
dtdf$main_category <- as.factor(dtdf$main_category)
dtdf$launched_year <- as.numeric(dtdf$launched_year)
dtdf$launched_month <- as.numeric(dtdf$launched_month)
dtdf$launched_day <- as.numeric(dtdf$launched_day)
dtdf$deadline_year <- as.numeric(dtdf$deadline_year)
dtdf$deadline_month <- as.numeric(dtdf$deadline_month)
dtdf$deadline_day <- as.numeric(dtdf$deadline_day)
dtree <- J48(status~., data = dtdf)
plot(dtree)
str(dtree)
summary(dtree)
write.arff(dtdf, file = "kickstarter.arff")
str(dtdf)
dtdf.slim <- dtdf[,-c(1,5,6,7,9,10,11)]
head(dtdf,5)
head(dtdf.slim,5)
write.arff(dtdf.slim, file = "kickstarterSlim.arff")
